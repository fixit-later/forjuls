<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>Envelope Animation</title>

  <style>
    *{margin:0;padding:0;box-sizing:border-box}

    body{
      min-height:100vh;width:100%;
      display:flex;justify-content:center;align-items:center;
      font-family:'Playfair Display','Georgia',serif;
      background:linear-gradient(180deg,#fde6ee,#fff6e8);
      overflow:hidden;
    }

    /* ===== ENVELOPE ===== */
    .wrapper{height:200px;width:300px;position:relative;display:flex;justify-content:center;perspective:1000px;transition:transform 1s cubic-bezier(.22,.61,.36,1), opacity .6s ease;cursor:pointer}
    .lid{position:absolute;height:100%;width:100%;top:0;left:0;border-right:150px solid transparent;border-bottom:100px solid transparent;border-left:150px solid transparent;transform-origin:top;transform-style:preserve-3d;backface-visibility:hidden;transition:transform .55s cubic-bezier(.22,.61,.36,1)}
    .lid.one{border-top:100px solid #f9f7f3;z-index:3;transition-delay:.75s}
    .lid.two{border-top:100px solid #f9f7f3;transform:rotateX(90deg);z-index:1;transition-delay:.5s}
    .envelope{position:absolute;height:100%;width:100%;top:0;left:0;border-top:100px solid transparent;border-right:150px solid #f9f7f3;border-bottom:100px solid #f2efe9;border-left:150px solid #f5f2ec;z-index:3;background-image:radial-gradient(rgba(0,0,0,.03) 1px, transparent 1px);background-size:6px 6px;filter:brightness(.98)}
    .wrapper.open .envelope{pointer-events:none}
    .letter{position:absolute;top:0;width:80%;height:80%;background:#fff;border-radius:15px;z-index:2;transition:transform .5s ease;display:flex;align-items:center;justify-content:center;pointer-events:none}
    .wrapper.open .letter{pointer-events:auto}
    .letter-content{display:flex;flex-direction:column;align-items:center}
    .letter p{font-size:30px;color:#3B4049;margin-bottom:14px}
    .open-letter{border:none;background:linear-gradient(180deg,#ff6f91,#ff9aa2);color:#fff;padding:6px 14px;border-radius:999px;font-size:12px;font-weight:600;box-shadow:0 6px 12px rgba(0,0,0,.18);cursor:pointer}
    .seal{position:absolute;top:50%;left:50%;transform:translate(-50%,-30%);font-size:28px;z-index:5;pointer-events:none;animation:pulse 2s ease-in-out infinite}
    @keyframes pulse{0%{transform:translate(-50%,-30%) scale(1)}50%{transform:translate(-50%,-30%) scale(1.08)}100%{transform:translate(-50%,-30%) scale(1)}}
    .wrapper.open .lid.one{transform:rotateX(90deg);transition-delay:0s}
    .wrapper.open .lid.two{transform:rotateX(180deg);transition-delay:.25s}
    .wrapper.open .letter{transform:translateY(-70px) scale(1.02);transition-delay:.5s}
    .wrapper.open .seal{opacity:0;animation:none}
    .wrapper.exit{transform:translateY(180px);opacity:0;pointer-events:none}

    /* ===== PAPER PAGE ===== */
    .paper-page{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:opacity .6s ease;z-index:10;background:linear-gradient(180deg,#fde6ee,#fff6e8)}
    body.show-paper .paper-page{opacity:1;pointer-events:auto}

    /* iPhone canvas â€“ Appleâ€‘like layout */
    .paper{
      width:100%;
      max-width:390px;
      height:100%;
      max-height:844px;
      background:linear-gradient(180deg,#fff1f5 0%,#fff8f0 100%);
      padding:calc(env(safe-area-inset-top) + 44px) 24px 24px;
      text-align:center;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:24px;
      font-family:-apple-system,BlinkMacSystemFont,'SF Pro Display','SF Pro Text',Helvetica,Arial,sans-serif;
      position:relative;
      overflow:hidden;
    }

    .badge{
      background:rgba(255,111,133,.12);
      color:#ff6f85;
      padding:6px 16px;
      border-radius:999px;
      font-size:13px;
      font-weight:600;
      letter-spacing:.2px;
      border:1px solid rgba(255,111,133,.25);
    }

    .paper h1{
      font-size:36px;
      font-weight:700;
      margin-top:8px;
      margin-bottom:4px;
      color:#ff6f85;
      letter-spacing:-.3px;
    }

    .paper p{
      font-size:17px;
      line-height:1.4;
      color:#1c1c1e;
      margin-bottom:8px;
    }

    .valentine-img{
      width:168px;
      height:168px;
      border-radius:28px;
      object-fit:cover;
      background:#fff;
      border:1px solid rgba(0,0,0,.06);
      box-shadow:
        0 18px 40px rgba(0,0,0,.12),
        inset 0 0 0 1px rgba(255,255,255,.6);
      margin:12px 0 4px;
    }

    /* ===== BUTTON ZONE (SIMPLIFIED) ===== */
    .button-container{
      position:absolute;
      bottom:60px;
      left:50%;
      transform:translateX(-50%);
      width:90%;
      max-width:320px;
      height:200px;
      opacity:0;
      animation:fadeIn .9s cubic-bezier(.34,1.56,.64,1) forwards;
      animation-delay:0.2s;
    }

    @keyframes fadeIn{
      from{ opacity:0; transform:translate(-50%, 40px); }
      to{ opacity:1; transform:translate(-50%, 0); }
    }

    .yes{
      position:absolute;
      top:0;
      left:50%;
      transform:translateX(-50%);
      width:50%;
      max-width:160px;
      padding:10px;
      border-radius:10px;
      border:none;
      background:linear-gradient(180deg,#ff7a90,#ff5f7d);
      color:#fff;
      font-size:14px;
      font-weight:600;
      letter-spacing:-.2px;
      box-shadow:0 6px 14px rgba(255,95,125,.35);
      cursor:pointer;
      animation:yesPulse 2.2s ease-in-out infinite;
      z-index:10;
    }

    .yes.highlight{
      box-shadow:0 0 0 0 rgba(255,45,85,.6);
      animation:highlightPulse 1.2s ease-in-out infinite;
    }

    @keyframes yesPulse{0%,100%{transform:translateX(-50%) scale(1)}50%{transform:translateX(-50%) scale(1.04)}}
    @keyframes highlightPulse{0%{box-shadow:0 0 0 0 rgba(255,45,85,.6)}70%{box-shadow:0 0 0 18px rgba(255,45,85,0)}100%{box-shadow:0 0 0 0 rgba(255,45,85,0)}}

    .no{
      position:absolute;
      top:55px;
      left:50%;
      transform:translateX(-50%);
      width:50%;
      max-width:160px;
      padding:9px;
      border-radius:10px;
      border:1px solid rgba(0,0,0,.12);
      background:#fff;
      color:#1c1c1e;
      font-size:13px;
      font-weight:500;
      cursor:pointer;
      z-index:5;
      transition:all .2s cubic-bezier(.25,.8,.25,1);
    }

    .no.surrender{animation:shake .35s ease-in-out 2}
    @keyframes shake{0%,100%{transform:translateX(-50%)}25%{transform:translateX(-54%)}50%{transform:translateX(-46%)}75%{transform:translateX(-52%)}}

    /* ===== CELEBRATION ===== */
    .celebrate{position:fixed;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;background:linear-gradient(180deg,#ffdde7,#fff6f9);z-index:20;opacity:0;pointer-events:none;transition:opacity .5s ease}
    body.show-celebrate .celebrate{opacity:1;pointer-events:auto}
    
    .celebrate h1{
      font-size:48px;
      font-weight:700;
      color:#ff6f85;
      z-index:21;
    }

    .emoji-rain{position:fixed;inset:0;overflow:hidden;pointer-events:none}
    .emoji{position:absolute;font-size:24px;animation:fall 3.5s linear infinite}
    @keyframes fall{from{transform:translateY(-10vh);opacity:1}to{transform:translateY(110vh);opacity:0}}
  
  </style>
</head>
<body>

  <div class="wrapper" id="wrapper">
    <div class="lid one"></div>
    <div class="lid two"></div>
    <div class="envelope"></div>
    <div class="seal">ðŸ’–</div>
    <div class="letter">
      <div class="letter-content">
        <p>Hi Juls</p>
        <button class="open-letter" id="continueBtn">Click here ðŸ’Œ</button>
      </div>
    </div>
  </div>

  <div class="paper-page">
    <div class="paper">
      <div class="badge">For Juls ðŸ’–</div>
      <h1>Hey Juls</h1>
      <img class="valentine-img" src="https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExNnRuOGhid3dpeW5pbjEwanV2OWx6amppMjB0Ynh2c2c2MTg3NGp6MCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/MDJ9IbxxvDUQM/giphy.gif" alt="Valentine" />
      <p>Will you be my Valentine? ðŸ’—</p>
      <div class="button-container">
        <button class="yes" id="yesBtn">Yes ðŸ’—</button>
        <button class="no" id="noBtn">No</button>
      </div>
    </div>
  </div>

  <div class="celebrate">
    <h1>SHE SAID YES ðŸ’–</h1>
    <div class="emoji-rain" id="emojiRain"></div>
  </div>

  <script>
    const wrapper = document.getElementById('wrapper');
    const continueBtn = document.getElementById('continueBtn');
    const yesBtn = document.getElementById('yesBtn');
    const noBtn = document.getElementById('noBtn');

    wrapper.addEventListener('click', e => {
      if (e.target.closest('.letter')) return;
      wrapper.classList.add('open');
    }, { once:true });

    continueBtn.addEventListener('click', e => {
      e.stopPropagation();
      wrapper.classList.add('exit');
      setTimeout(() => {
        document.body.classList.add('show-paper');
        wrapper.style.display = 'none';
      }, 600);
    }, { once:true });

    let dodgeCount = 0;
    const MAX_DODGES = 15;
    
    const banterTexts = [
      'No',
      'Nope ðŸ˜',
      'Still no ðŸ™ƒ',
      'Not happening ðŸ˜œ',
      'Nice try! ðŸ˜†',
      'Nah ðŸ¤ª',
      'Keep trying ðŸ˜',
      'Almost! ...not ðŸ˜‚',
      'So close! ðŸ¤­',
      'Try again ðŸ˜‹',
      'Getting tired? ðŸ˜Œ',
      'One more time? ðŸ™ˆ',
      'Really? ðŸ˜…',
      'Come on... ðŸ¥º',
      'Fine... maybe ðŸ˜³'
    ];

    function moveNo(e){
      e.preventDefault();
      e.stopPropagation();

      if(dodgeCount >= MAX_DODGES){
        noBtn.textContent = 'okay okay YES ðŸ’–';
        noBtn.classList.add('surrender');
        yesBtn.classList.add('highlight');
        noBtn.removeEventListener('click', moveNo);
        noBtn.removeEventListener('touchstart', moveNo);
        return;
      }

      dodgeCount++;
      
      // Update button text with banter
      noBtn.textContent = banterTexts[dodgeCount % banterTexts.length];

      const container = document.querySelector('.button-container');
      const containerRect = container.getBoundingClientRect();
      const noRect = noBtn.getBoundingClientRect();
      const yesRect = yesBtn.getBoundingClientRect();
      
      const pad = 5; // Reduced padding for more range
      
      // Calculate boundaries within container
      const minX = pad;
      const maxX = containerRect.width - noRect.width - pad;
      const minY = 55; // Below Yes button
      const maxY = containerRect.height - noRect.height - pad;

      let x, y;
      let attempts = 0;
      let tooClose;
      
      do{
        // Random position within container - more unpredictable
        x = minX + Math.random() * (maxX - minX);
        y = minY + Math.random() * (maxY - minY);
        attempts++;
        
        // Check if too close to Yes button (relative to container)
        const yesX = yesRect.left - containerRect.left;
        const yesY = yesRect.top - containerRect.top;
        
        const buffer = 10; // Smaller buffer for more chaos
        tooClose = (
          x < yesX + yesRect.width + buffer &&
          x + noRect.width > yesX - buffer &&
          y < yesY + yesRect.height + buffer &&
          y + noRect.height > yesY - buffer
        );
        
      } while(tooClose && attempts < 100);

      // Apply position with faster transition
      noBtn.style.transition = 'all .2s cubic-bezier(.25,.8,.25,1)';
      noBtn.style.left = x + 'px';
      noBtn.style.top = y + 'px';
      noBtn.style.transform = 'none';
    }

    noBtn.addEventListener('click', moveNo);
    noBtn.addEventListener('touchstart', moveNo, { passive:false });

    yesBtn.addEventListener('click', () => {
      document.querySelector('.paper-page').style.opacity = '0';
      setTimeout(() => {
        document.body.classList.add('show-celebrate');
        startEmojiRain();
      }, 400);
    }, { once:true });

    function startEmojiRain(){
      const rain = document.getElementById('emojiRain');
      const hearts = ['ðŸ’–','ðŸ’—','ðŸ’˜','ðŸ’•','ðŸ’ž'];
      rain.innerHTML = '';
      for(let i=0;i<40;i++){
        const span = document.createElement('span');
        span.className = 'emoji';
        span.textContent = hearts[Math.floor(Math.random()*hearts.length)];
        span.style.left = Math.random()*100 + 'vw';
        span.style.animationDelay = Math.random()*3 + 's';
        span.style.fontSize = 18 + Math.random()*14 + 'px';
        rain.appendChild(span);
      }
    }
  </script>

</body>
</html>
